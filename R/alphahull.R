
#' Compute convex scagnostic measures
#'
#' @examples
#'   require(ggplot2)
#'   require(tidyr)
#'   require(dplyr)
#'   data(anscombe)
#'   anscombe_tidy <- anscombe %>%
#'   pivot_longer(cols = everything(),
#'     names_to = c(".value", "set"),
#'     names_pattern = "(.)(.)")
#'   ggplot(anscombe_tidy, aes(x=x, y=y)) +
#'     geom_point() +
#'     facet_wrap(~set, ncol=2, scales = "free")
#'   a_s <- scree(anscombe$x1, anscombe$y1)
#'   sc_convex(a_s)
#'   a_s <- scree(anscombe$x2, anscombe$y2)
#'   sc_convex(a_s)
#'   a_s <- scree(anscombe$x3, anscombe$y3)
#'   sc_convex(a_s)
#'   a_s <- scree(anscombe$x4, anscombe$y4)
#'   sc_convex(a_s)
#' @export
sc_convex <- function(x, y) UseMethod("sc_convex")

#' @export
sc_convex.scree <- function(x,y = NULL) {
  stopifnot(is.null(y))
  chull <- gen_conv_hull(x$del)
  #chull_area <- splancs::areapl(cbind(chull$x, chull$y))
  ahull <- gen_alpha_hull(x$del, x$alpha)
  #ahull_area <- alphahull::areaahull(ahull)
  #ahull_area / chull_area
  sc_convex.hull(chull, ahull)
}

#' @export
sc_convex.default <- function(x, y){
  sc <- scree(x, y)
  sc_convex.scree(sc)
}

#' @export
sc_convex.hull <- function(chull, ahull){
  chull_area <- splancs::areapl(cbind(chull$x, chull$y))
  ahull_area <- alphahull::areaahull(ahull)
  ahull_area / chull_area
}

#' Compute convex scagnostic measures
#'
#' @examples
#'   require(ggplot2)
#'   require(tidyr)
#'   require(dplyr)
#'   data(anscombe_tidy)
#'   anscombe_tidy <- anscombe %>%
#'   pivot_longer(cols = everything(),
#'     names_to = c(".value", "set"),
#'     names_pattern = "(.)(.)")
#'   ggplot(anscombe_tidy, aes(x=x, y=y)) +
#'     geom_point() +
#'     facet_wrap(~set, ncol=2, scales = "free")
#'   a_s <- scree(anscombe$x1, anscombe$y1)
#'   sc_skinny(a_s)
#'   a_s <- scree(anscombe$x2, anscombe$y2)
#'   sc_skinny(a_s)
#'   a_s <- scree(anscombe$x3, anscombe$y3)
#'   sc_skinny(a_s)
#'   a_s <- scree(anscombe$x4, anscombe$y4)
#'   sc_skinny(a_s)
#' @export
sc_skinny <- function(x, y) UseMethod("sc_skinny")

#' @export
sc_skinny.scree <- function(x, y = NULL) {
  stopifnot(is.null(y))
  ahull <- gen_alpha_hull(x$del, x$alpha)
  #ahull_area <- alphahull::areaahull(ahull)
  #1 - sqrt(4*pi * ahull_area) / ahull$length
  sc_skinny.hull(ahull)
}

#' @export
sc_skinny.default <- function(x, y){
  sc <- scree(x, y)
  sc_skinny.scree(sc)
}

#' @export
sc_skinny.hull <- function(ahull){
  ahull_area <- alphahull::areaahull(ahull)
  1 - sqrt(4*pi * ahull_area) / ahull$length
}

gen_conv_hull <- function(del) {
  tripack::convex.hull(del$tri.obj)
}

gen_alpha_hull <- function(del, alpha) {
  alphahull::ahull(del, alpha = alpha)
}
